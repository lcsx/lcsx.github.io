(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{246:function(n,t,s){n.exports=s.p+"assets/img/01.a80f4a36.png"},272:function(n,t,s){"use strict";s.r(t);var a=s(28),e=Object(a.a)({},(function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[a("h1",{attrs:{id:"部署与配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署与配置"}},[n._v("#")]),n._v(" 部署与配置")]),n._v(" "),a("p",[n._v("SSH 登录服务器\n买云服务器后，会给你一个公网Ip、用户名、密码，就可以用ssh登录了")]),n._v(" "),a("p",[n._v("安装git，下载代码到服务器\n安装node.js")]),n._v(" "),a("p",[n._v("登录\n本机git bash：")]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v("$ ssh root@39.97.xx.ip\n//在输入密码 就登录上了\n\n//安装乌班图git\napp-get install git\n\n//从git clone 程序包\ngit clone http://sssssssssss.git\n\n//查看文件目录\n$ ls \n[比如现在有文件 restful-nodejs   zhihu-api]\n\n//可以删除不要的  \n$ rm -rf rest*\n\n$ cd zhihu*\n\n//安装nodejs\n//https://github.com/nodesource/distributions/blob/master/README.md\n//sudo 管理员权限\ncurl -sL https://rpm.nodesource.com/setup_11.x | bash -\nsudo apt-get install -y nodejs\n\n//安装依赖\nnpm i\n\n//运行程序\nnode app\n\n")])])]),a("p",[n._v("程序写的时候运行在3000端口，但服务器基于安全考虑，对外暴露的端口比较少，有80，有334，不改代码端口怎么正常运行呢？用nginx")]),n._v(" "),a("h4",{attrs:{id:"nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[n._v("#")]),n._v(" nginx")]),n._v(" "),a("p",[n._v("反向代理工具，把外网的80端口转到内网的3000端口")]),n._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[n._v("// 安装nginx\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("apt-get")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("install")]),n._v(" nginx\n\n//如何配置nginx 告诉你配置文件在哪里的\n$ nginx -t\n//返回一些信息 包括配置文库目录  /etc/nginx/nginx.conf\n\n//编辑配置文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("vim")]),n._v(" /etc/nginx/nginx.cofg\n\n//改什么好呢\n//先注释掉默认的80端口配置\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# include /etc/nginx/sites-enabled/*")]),n._v("\n//添加80端口转发\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n\tlisten "),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\tserver_name localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\tlocation / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n\t\tproxy_pass http://127.0.0.1:3000\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n//保存并退出\n:wq\n//只退出是q\n\n\n//最好先检测下配置ok不ok,语法对不对\n$ nginx -t\n\n//如何让配置生效 \n//1.重启nginx\n$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[n._v("service")]),n._v(" nginx restart\n\n//2.\n"),a("span",{pre:!0,attrs:{class:"token number"}},[n._v("2")]),n._v(".service nginx reload\n\n\n//搞定\n")])])]),a("h4",{attrs:{id:"postman设置host"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postman设置host"}},[n._v("#")]),n._v(" postman设置host")]),n._v(" "),a("p",[n._v("接口在远程服务器上了，那本地postman的怎么来测试呢？\npostman的接口地址都是localhost:3000 ，可以设置环境变量来将host统一切换")]),n._v(" "),a("p",[n._v("设置--\x3e Add Environment")]),n._v(" "),a("h3",{attrs:{id:"精美的接口文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#精美的接口文档"}},[n._v("#")]),n._v(" 精美的接口文档")]),n._v(" "),a("p",[n._v("caocaocao吊炸天/就是有点慢\n"),a("img",{attrs:{src:s(246),alt:"An image"}})]),n._v(" "),a("h2",{attrs:{id:"pm2管理进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pm2管理进程"}},[n._v("#")]),n._v(" pm2管理进程")]),n._v(" "),a("p",[n._v("当我本地关掉gitbash 的时候，我x咧，服务器的node服务也停了~~~！\n如何使程序在后台不停运行呢-------pm2管理进程")]),n._v(" "),a("p",[n._v("我们要做的内容有")]),n._v(" "),a("ol",[a("li",[n._v("安装PM2")]),n._v(" "),a("li",[n._v("使用pm2启动、停止、重启、重载程序")]),n._v(" "),a("li",[n._v("使用pm2的日志、环境变量管理功能")])]),n._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[n._v('//bash 登录到远程服务器后  cd 到zhihu* \n\n//安装\nnpm i pm2 -g\n\n//运行\npm2 start app\n\n//如何停止\n//pm2 stop 名称\n\npm2 stop app\n//关掉所有\npm2 stop all \n\n//如何知道名称\npm2 ls\n\n//重启    这个重启是会终端服务的\npm2 restart app\n\n//不间断重启\npm2 reload app\n\n//添加环境变量\nNODE_ENV=PRODUCTION pm2 start app --update-env\n\n这个就是\n"scripts": {\n    "start": "cros-env NODE_ENV=production node app",\n    "dev": "nodemon app"\n},\n\n\n//查看日志\npm2 log  app\n\n//将日期时间，在日志中能显示，怎么办\nNODE_ENV=PRODUCTION pm2 start app --update-env --log-date-formate "YYYY-MM-DD HH:mm"\n')])])])])}),[],!1,null,null,null);t.default=e.exports}}]);